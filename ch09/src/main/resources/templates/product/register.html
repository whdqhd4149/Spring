<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
    <section id="productRegister">
        <nav>
            <h3>상품등록</h3>
        </nav>

        <article>
            <form th:action="@{/product}" method="post" enctype="multipart/form-data">
                <table border="1">
                    <tr>
                        <td>상품명</td>
                        <td>
                            <input type="text" name="productName" />
                        </td>
                    </tr>
                    <tr>
                        <td>카테고리</td>
                        <td>
                            <select id="category" name="category">
                                <option>종류</option>
                                <option value="10">의류</option>
                                <option value="11">식품</option>
                                <option value="12">가전</option>
                                <option value="13">뷰티</option>
                            </select>

                            <span id="cate2Wrap" style="display:none; margin-left:8px;">
                              <select id="cate2" name="cate2">
                                <option value="">소분류 선택</option>
                              </select>
                            </span>
                        </td>
                    </tr>

                        <td>가격</td>
                        <td>
                            <input type="number" name="price"/>
                        </td>
                    </tr>
                    <tr>
                        <td>포인트</td>
                        <td>
                            <input type="number" name="point" />포인트는 가격의 1%</td>
                    </tr>
                    <tr>
                        <td>할인</td>
                        <td>
                            <select name="discount">
                                <option value="5">5%</option>
                                <option value="12">12%</option>
                                <option value="15">15%</option>
                                <option value="18">18%</option>
                                <option value="20">20%</option>
                            </select>
                        </td>
                    </tr>
                    <tr>
                        <td>배송비</td>
                        <td>
                            <label><input type="radio" name="delivery" value="2000"/>2,000원</label>
                            <label><input type="radio" name="delivery" value="3000"/>3,000원</label>
                            <label><input type="radio" name="delivery" value="5000"/>5,000원</label>
                            <label><input type="radio" name="delivery" value="0"/>무료</label>
                        </td>
                    </tr>
                    <tr>
                        <td>재고</td>
                        <td><input type="number" name="stock" /></td>
                    </tr>
                    <tr>
                        <td>상품이미지</td>
                        <td>
                            <p>
                                <span>상품목록 이미지(약 120 x 120)</span>
                                <input type="file" name="thumbFile120" />
                            </p>
                            <p>
                                <span>기본정보 이미지(약 240 x 240)</span>
                                <input type="file" name="thumbFile240" />
                            </p>
                            <p>
                                <span>상품설명 이미지(약 750 x Auto)</span>
                                <input type="file" name="thumbFile750" />
                            </p>
                        </td>
                    </tr>
                    <tr>
                        <td>기타</td>
                        <td><textarea name="etc"></textarea></td>
                    </tr>
                </table>

                <p>
                    <a href="#" class="btnCancel">취소</a>
                    <input type="submit" value="상품등록" />
                </p>
            </form>
            <script>
                // 대분류별 소분류 코드(플러터/DB랑 동일해야 함)
                const CATE2_MAP = {
                    "10": [ // 의류
                        { id: 10, name: "상의" },
                        { id: 11, name: "하의" },
                        { id: 12, name: "아우터" },
                    ],
                    "11": [ // 식품
                        { id: 20, name: "과일" },
                        { id: 21, name: "채소" },
                        { id: 22, name: "정육" },
                    ],
                    "12": [ // 가전
                        { id: 30, name: "TV" },
                        { id: 31, name: "냉장고" },
                        { id: 32, name: "세탁기" },
                    ],
                    "13": [ // 뷰티
                        { id: 40, name: "화장품" },
                        { id: 41, name: "향수" },
                        { id: 42, name: "스킨케어" },
                    ],
                };

                const category = document.getElementById('category');
                const cate2Wrap = document.getElementById('cate2Wrap');
                const cate2 = document.getElementById('cate2');

                function renderCate2() {
                    const key = category.value;
                    cate2.innerHTML = '<option value="">소분류 선택</option>';
                    if (!key || !CATE2_MAP[key]) {
                        cate2Wrap.style.display = 'none';
                        return;
                    }
                    CATE2_MAP[key].forEach(sub => {
                        const opt = document.createElement('option');
                        opt.value = sub.id;       // ★ DB에 저장될 cate2 코드
                        opt.textContent = sub.name;
                        cate2.appendChild(opt);
                    });
                    cate2Wrap.style.display = '';
                }
                category.addEventListener('change', renderCate2);
                renderCate2(); // 초기 렌더
            </script>


        </article>
    </section>
</body>
</html>